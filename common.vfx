\ ------------------------------------------------------------------------------
\ Global stuff
\ ------------------------------------------------------------------------------

bgm bgm1 crack.xm
tileset.png 16 16 +tileset tileset.ts
bg.png 16 16 +tileset bg.ts
bg.ts 0 tile pile !
s" gfx\bg.dat" bg.ts load-metas 
0 value p1 

\ Platforming
include platformer.vfx

\ Misc
: level ( n - ) 
    room revert ;

: frmspin ( bmp# len ms - )
    mstime swap / swap mod + bmp ! ;

: keep-in ( x y w h - )
    4>. | bh bw by bx |
    x 2@ bx by 2+ 0 0 gamew. gameh. bw bh 2- 2clamp bx by 2- x 2! ;

: in? ( - f )
    x @ -8. gamew. 8. + within?
    y @ -8. gameh. 8. + within? and ;

: ?cull ( - ) in? ?exit me unload ;

\ Moneybags
c: %moneybag ;
: enlighten  actives> me %moneybag is? -exit appear ;
: veil  actives> me %moneybag is? -exit vanish ;
