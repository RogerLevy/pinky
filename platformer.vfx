\ ------------------------------------------------------------------------------
\ Platformer System
\ WIP
\ ------------------------------------------------------------------------------

trait: %platformer
    prop hp
    prop fac
    prop gravity
    prop falling
    prop in-air
    prop jumppower 
    prop risepower 
    prop walkspeed
    prop inertia
    prop climbing

    :: _walk  drop ;  : walk  me _walk ;
    :: _jump ;        : jump  in-air on  me _jump ;
    :: _squat ;       : squat  me _squat ;
    :: _idle ;        redef : idle  me _idle ;
    :: _die ;         : die  me _die ;
    :: _fall ;        
    \ m: kill ;
    :: burn ;
    :: _climb ;       : climb me _climb ;
trait;

: revive   100 hp ! idle ;
: ?die  hp @ 0 <= -exit die ;

: fall
    in-air on
    falling @ not  if  falling on  me _fall  then ;
    \ ; \ in-air on falling on me _fall ;
